
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>new life</title>
            <link rel="stylesheet" href="site.css">
        </head>
        <body>
            <div id="wrapper">
                <h1>How transformers work</h1>
<p>Basically you have a couple important steps in a decoder-only transformer. I'm going to explain this in the context of generative language models first. Fundamentally, though, any sequential prediction task can use a transformer -- from <a href="https://arxiv.org/pdf/2106.01345">decision transformers</a> to <a href="https://huggingface.co/docs/transformers/model_doc/vit">image transformers</a>, and probably to some crazy obscure things I've never heard of as well.</p>
<p>(Encoder-decoder transformers, like the ones in <a href="https://arxiv.org/pdf/1706.03762">the orignal paper</a>, are pretty cool, and I have weird half-baked theories about how they relate to language production, but it's easier to figure things out initially just with decoders. If you don't know the difference, don't worry about it right now. You can learn the difference later. For now, just think, "LLMs like ChatGPT are decoder-only, text classification models like BERT are encoder-only, and machine translation models are encoder-decoder.")</p>
<ol>
<li>Embedding (semantic + positional) </li>
<li>Flows through a bunch of transformer blocks<ol>
<li>"residual stream" is just the input -- the initial embedding if it's the first layer of the transformer, and in later layers it's just the output of the previous layer</li>
<li>You take the input and run it through multi-head attention, combining together all the attention heads' outputs and adding it to the residual stream</li>
<li>Then you take the newly-updated residual stream and put it through an MLP network, and then output it to the next transformer block or just send it to unembedding</li>
</ol>
</li>
<li>After you've gone through all the transformer blocks/layers, you use softmax to turn everything into probabilities, and then you get your output -- a probability distribution over the next token. </li>
</ol>
<p>I'll try and explain the intuitions for each thing, and how it actually works inside -- probably stay at least for the intuitions since these seem to be skipped by many resources, and then refer to other better-written resources for technical details on internal implementations. I'll link some, probably, once I write the sections.</p>
            </div>
            <script type="text/javascript" src="mathjax.js"></script>
            <script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
        </body>
        </html>
        